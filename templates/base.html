{% load static %} {% load compress %}
<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SDI AM FATWA - {% block title %}{% endblock %}</title>

    <link rel="icon" type="image/webp" href="{% static 'img/logo.webp' %}" />

    <style>
      /* PAKSA BODY KELIATAN (BIAR PRELOADER MUNCUL) */
      body {
        opacity: 1 !important;
        visibility: visible !important;
        margin: 0 !important;
        padding: 0 !important;
      }

      #preloader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #ffffff;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 999999;
        opacity: 1;
        transition: opacity 0.5s ease;
      }
      #preloader.fade-out {
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
      }
      .preloader-logo {
        width: 120px;
        height: 120px;
        animation: logoPulse 2s ease-in-out infinite;
      }
      @keyframes logoPulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
      }
      .preloader-progress {
        width: 200px;
        height: 4px;
        background: rgba(24, 154, 106, 0.2);
        border-radius: 4px;
        overflow: hidden;
        margin-top: 1.5rem;
      }
      .preloader-bar {
        width: 0;
        height: 100%;
        background: #189a6a;
        transition: width 0.3s ease;
      }

      /* LOGIC PRELOADER YANG BENER (SEMBUNYIIN KONTEN, BUKAN BODY) */
      .page-content {
        opacity: 0;
        transition: opacity 0.5s ease;
      }
      body.page-loaded .page-content {
        opacity: 1;
      }

      /* PAKSA HILANGIN GAP DI HERO SECTION */
      .hero-section {
        padding-top: 0 !important;
        padding-bottom: 0 !important;
        margin-top: 0 !important;
      }
      
      /* SOLUSI HILANGKAN GAP ANTARA NAVBAR DAN KONTEN */
      .navbar {
        margin-bottom: 0 !important;
      }
      
      .page-content > *:first-child {
        margin-top: 0 !important;
        padding-top: 0 !important;
      }
      
      /* Reset container untuk menghilangkan gap */
      .container-fluid, .container {
        padding-top: 0 !important;
      }
      
      /* Reset untuk elemen pertama di dalam container */
      .container > *:first-child,
      .container-fluid > *:first-child {
        margin-top: 0 !important;
        padding-top: 0 !important;
      }

      .admin-button {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-color: rgba(24, 154, 106, 0.15);
        color: #189a6a;
        display: none;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        opacity: 0.7;
        transition: all 0.3s ease;
        z-index: 1040;
        font-size: 20px;
      }
      .admin-button:hover {
        opacity: 1;
        background-color: #189a6a;
        color: #ffffff;
        transform: scale(1.05);
        box-shadow: 0 4px 10px rgba(24, 154, 106, 0.4);
      }
    </style>

    {% compress css %}
    <link
      rel="stylesheet"
      href="{% static 'vendor/bootstrap/bootstrap.min.css' %}"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="{% static 'vendor/fontawesome/all.min.css' %}"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="{% static 'css/style.css' %}"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="{% static 'css/animations.css' %}"
      type="text/css"
    />
    {% endcompress %} {% block extra_css %}{% endblock %}
  </head>
  <body class="{% block body_class %}{% endblock %}">
    <div id="preloader">
      <div
        class="preloader-content"
        style="display: flex; flex-direction: column; align-items: center"
      >
        <img
          src="{% static 'img/logo.webp' %}"
          alt="Loading..."
          class="preloader-logo"
        />
        <div class="preloader-progress">
          <div class="preloader-bar"></div>
        </div>
      </div>
    </div>

    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <div class="container">
        <a class="navbar-brand" href="{% url 'home' %}">
          <img src="{% static 'img/logo.webp' %}" alt="Logo" height="40" />
          SDI AM FATWA
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a
                class="nav-link {% if request.resolver_match.url_name == 'home' %}active{% endif %}"
                href="{% url 'home' %}"
                >Beranda</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link profile-link" href="{% url 'home' %}#profil"
                >Profil</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link {% if 'berita' in request.resolver_match.url_name %}active{% endif %}"
                href="{% url 'berita_list' %}"
                >Berita</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link {% if 'agenda' in request.resolver_match.url_name %}active{% endif %}"
                href="{% url 'agenda_list' %}"
                >Agenda</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link {% if 'galeri' in request.resolver_match.url_name %}active{% endif %}"
                href="{% url 'galeri_list' %}"
                >Galeri</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link {% if 'kontak' in request.resolver_match.url_name %}active{% endif %}"
                href="{% url 'kontak' %}"
                >Kontak</a
              >
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="page-content">
      {% block content %}{% endblock %}

      <footer class="bg-dark text-white py-4 mt-5">
        <div class="container">
          <div class="row">
            <div class="col-md-4">
              <h5>SDI AM FATWA</h5>
              <p>
                Jl. Kramat Pulo Gundul No.2, RT.2/RW.9, Tanah Tinggi, Kec. Johar
                Baru, Kota Jakarta Pusat, DKI Jakarta 10450
              </p>
              <p><i class="fas fa-phone"></i> 0838-0553-0371</p>
              <p>
                <i class="fab fa-whatsapp"></i>
                <a
                  href="https://wa.me/6283805530371"
                  class="text-white"
                  target="_blank"
                  >Chat via WhatsApp</a
                >
              </p>
              <p><i class="fas fa-envelope"></i> sdi.amfatwa@gmail.com</p>
            </div>

            <div class="col-md-4">
              <h5>Link Cepat</h5>
              <ul class="list-unstyled">
                <li>
                  <a
                    href="{% url 'home' %}#profil"
                    class="text-white profile-link"
                    >Profil</a
                  >
                </li>
                <li>
                  <a href="{% url 'berita_list' %}" class="text-white"
                    >Berita</a
                  >
                </li>
                <li>
                  <a href="{% url 'agenda_list' %}" class="text-white"
                    >Agenda</a
                  >
                </li>
                <li>
                  <a href="{% url 'galeri_list' %}" class="text-white"
                    >Galeri</a
                  >
                </li>
                <li>
                  <a href="{% url 'kontak' %}" class="text-white">Kontak</a>
                </li>
              </ul>
            </div>

            <div class="col-md-4">
              <h5>Ikuti Kami</h5>
              <div class="social-links">
                <a
                  href="https://web.facebook.com/amf.fatwa.5"
                  class="text-white me-2"
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  <i class="fab fa-facebook fa-2x"></i>
                </a>
                <a
                  href="https://www.instagram.com/sdiamfatwa/"
                  class="text-white me-2"
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  <i class="fab fa-instagram fa-2x"></i>
                </a>
                <a
                  href="https://www.youtube.com/@sdiamfatwa4752"
                  class="text-white me-2"
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  <i class="fab fa-youtube fa-2x"></i>
                </a>
                <a
                  href="https://wa.me/6283805530371"
                  class="text-white"
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  <i class="fab fa-whatsapp fa-2x"></i>
                </a>
              </div>
            </div>
          </div>

          <hr class="bg-white" />

          <div class="text-center">
            <p>&copy; {% now "Y" %} 
              <a 
                href="{% url 'admin:index' %}" 
                target="_blank" 
                rel="noopener noreferrer" 
                class="text-white text-decoration-none"
                title="Admin Login"
              >SDI AM FATWA</a>. All rights reserved.</p>
          </div>
        </div>
      </footer>
    </div>

    {% compress js %}
    <script
      src="{% static 'vendor/bootstrap/bootstrap.bundle.min.js' %}"
      type="text/javascript"
    ></script>
    <script src="{% static 'js/main.js' %}" type="text/javascript"></script>
    <script
      src="{% static 'js/scroll-position.js' %}"
      type="text/javascript"
    ></script>
    <script src="{% static 'js/animations.js' %}" type="text/config"></script>
    {% endcompress %}

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const preloader = document.getElementById("preloader");
        const preloaderBar = document.querySelector(".preloader-bar");
        const body = document.body;

        if (preloader && preloaderBar) {
          let width = 0;
          const fakeProgress = setInterval(() => {
            width += 5;
            if (width > 90) {
              clearInterval(fakeProgress);
            }
            preloaderBar.style.width = width + "%";
          }, 100);

          window.addEventListener("load", function () {
            clearInterval(fakeProgress);
            preloaderBar.style.width = "100%";

            setTimeout(() => {
              preloader.classList.add("fade-out");
              body.classList.add("page-loaded");

              setTimeout(() => {
                preloader.style.display = "none";
              }, 500);
            }, 400);
          });
        } else {
          body.classList.add("page-loaded");
        }

        const profileLinks = document.querySelectorAll(".profile-link");
        profileLinks.forEach((link) => {
          link.addEventListener("click", function (e) {
            e.preventDefault();

            const homeUrl = "{% url 'home' %}";
            const currentPath = window.location.pathname;
            const isHomePage =
              currentPath === homeUrl ||
              (homeUrl === "/" && currentPath === "/");

            if (isHomePage) {
              const profilSection = document.getElementById("profil");
              if (profilSection) {
                const navbarHeight =
                  document.querySelector(".navbar").offsetHeight;
                window.scrollTo({
                  top: profilSection.offsetTop - navbarHeight - 20,
                  behavior: "smooth",
                });
              }
            } else {
              window.location.href = "{% url 'home' %}#profil";
            }
          });
        });

        if (window.location.hash === "#profil") {
          setTimeout(() => {
            const profilSection = document.getElementById("profil");
            if (profilSection) {
              const navbarHeight =
                document.querySelector(".navbar").offsetHeight;
              window.scrollTo({
                top: profilSection.offsetTop - navbarHeight - 20,
                behavior: "smooth",
              });
            }
          }, 600);
        }
      });
    </script>

    {% block extra_js %}{% endblock %}
  </body>
</html>